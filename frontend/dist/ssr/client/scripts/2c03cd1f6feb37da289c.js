!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VsMarketoForm=e():t.VsMarketoForm=e()}(window,(function(){return(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[226],{"5zGy":function(t,e,a){"use strict";var n=a("QeFQ");a.d(e,"a",(function(){return n.a})),a.d(e,"b",(function(){return n.b}))},"66kC":function(t,e,a){"use strict";a("ma9I"),a("TeQF"),a("fbCW"),a("QWBl"),a("yXV3"),a("pDQq"),a("sMBO"),a("T63A"),a("tkto"),a("FZtP");var n=a("J4zp"),i=a.n(n),s=a("oCYn"),r=a("iAdB"),o=a("JXrT"),d=a("mCqV"),l=a("Jyjn"),f=a("oqxP"),g=a("vWRs"),u=a("NO4K"),c=a("kNtj"),m=a("Yaxr"),h=a("vDqi");e.a={name:"VsMarketoForm",status:"prototype",release:"0.0.1",components:{VsInput:o.default,VsSelect:d.default,VsCheckbox:l.default,BFormGroup:r.a,VsRecaptcha:g.default,VsButton:u.default,VsIcon:f.default,VsHeading:c.default},mixins:[m.a],props:{dataUrl:{type:String,required:!0},recaptchaKey:{type:String,required:!0},recaptchaTextareaLabel:{type:String,default:"Does not need any text"},isProd:{type:Boolean,default:!1},munchkinId:{type:String,required:!0},marketoInstance:{type:String,required:!0},language:{type:String,default:"en"},messagingUrl:{type:String,required:!0},countryListUrl:{type:String,default:""}},data:function(){return{submitted:!1,submitting:!1,submitError:!1,formData:{},messagingData:{},form:{},formIsInvalid:!1,showErrorMessage:!1,errorFields:[],triggerValidate:!1,recaptchaVerified:!1,conditionalFields:{},inputVal:""}},computed:{formId:function(){return this.isProd?this.formData.formLiveId:this.formData.formSandboxId},showFormHeading:function(){return!this.isUndefined(this.getTranslatedContent)&&!this.isUndefined(this.getTranslatedContent("heading"))}},created:function(){this.getFormData(),this.getGlobalMessaging()},methods:{getFormData:function(){var t=this;h.get(this.dataUrl).then((function(e){t.formData=e.data,window.MktoForms2&&window.MktoForms2.loadForm(t.marketoInstance,t.munchkinId,t.formId),e.data.fields.forEach((function(e){t.form[e.name]="",e.conditional&&s.a.set(t.conditionalFields,e.name,!1)}))}))},getGlobalMessaging:function(){var t=this;h.get(this.messagingUrl).then((function(e){t.messagingData=e.data}))},getLanguageObj:function(){return this.isUndefined(this.formData[this.language])?{}:this.formData[this.language]||void 0},getTranslatedLabel:function(t,e){var a=this.getLanguageObj(),n="";return n="en"===this.language||this.isUndefined(a[t])||this.isUndefined(a[t].label)?this.formData.fields[e].label:a[t].label,this.showOptionalText(this.formData.fields[e])&&!this.isUndefined(this.getMessagingData("optional",this.language))&&(n="".concat(n," (").concat(this.getMessagingData("optional",this.language),")")),n},getTranslatedLegend:function(t,e){var a=this.getLanguageObj();return"en"===this.language||this.isUndefined(a[t])||this.isUndefined(a[t].descriptor)?this.formData.fields[e].descriptor:a[t].descriptor},getTranslatedInfo:function(t,e){var a=this.getLanguageObj();return"en"===this.language||this.isUndefined(a[t])||this.isUndefined(a[t].info)?this.formData.fields[e].info:a[t].info},getTranslatedValidation:function(t,e){var a,n=this.getLanguageObj();return"en"!==this.language||this.isUndefined(this.formData.fields[e].validationMessages)?this.isUndefined(n[t])||this.isUndefined(n[t].validationMessages)?"en"===this.language&&(a=this.formData.fields[e].validationMessages):a=n[t].validationMessages:a=this.formData.fields[e].validationMessages,a},getTranslatedOptions:function(t,e){var a=this.getLanguageObj(),n=[];return void 0===(n="en"===this.language||this.isUndefined(a[t])||this.isUndefined([t].options)?this.formData.fields[e].options:a[t].options)&&(n=[]),n},getTranslatedHint:function(t,e){var a=this.getLanguageObj();return"en"===this.language||this.isUndefined(a[t])||this.isUndefined(a[t].hint)?this.isUndefined(this.formData.fields[e].hint)?"":this.formData.fields[e].hint:a[t].hint},getTranslatedContent:function(t){var e=this.getLanguageObj();return"en"!==this.language||this.isUndefined(this.formData.content)||this.isUndefined(this.formData.content[t])?this.isUndefined(e.content)||this.isUndefined(e.content[t])?this.getMessagingData(t,this.language):e.content[t]:this.formData.content[t]},getMessagingData:function(t,e){return Object.keys(this.messagingData).length>0?this.messagingData[e][t]:"validation"===t?{}:""},isUndefined:function(t){return void 0===t},updateFieldData:function(t){this.form[t.field]=t.value||"",Array.isArray(t.errors)?this.formIsInvalid=t.errors.length>0:this.formIsInvalid=t.errors,this.manageErrorStatus(t.field,t.errors),this.checkConditionalFields()},manageErrorStatus:function(t,e){var a=this.errorFields.indexOf(t);-1!==a?(!e||e.length<1)&&this.errorFields.splice(a,1):e&&e.length>0&&this.errorFields.push(t)},showOptionalText:function(t){return!(!this.isUndefined(t.validation)&&!this.isUndefined(t.validation.required))},needsLabel:function(t){return"radio"!==t.element&&"submit"!==t.element&&"checkbox"!==t.element},preSubmit:function(t){var e=this;t.preventDefault(),this.onRecaptchaVerify(),this.triggerValidate=!0;var a=this.formData.fields.filter((function(t){return t.validation&&t.validation.required}));0===a.length?this.formIsInvalid=!1:a.forEach((function(t){""===e.form[t.name]&&(e.formIsInvalid=!0)})),this.showErrorMessage=this.formIsInvalid.length>1,Object.entries(this.conditionalFields).forEach((function(t){var a=i()(t,2),n=a[0];a[1]||(e.form[n]="")})),this.errorFields.length>0&&(this.formIsInvalid=!0),!this.formIsInvalid&&this.recaptchaVerified?this.marketoSubmit():this.showErrorMessage=!0},marketoSubmit:function(){var t=this;this.createDataLayerObject("formsDataEvent");var e=window.MktoForms2.allForms()[0];e.addHiddenFields(this.form),e.addHiddenFields({lastReCAPTCHAUserFingerprint:window.grecaptcha.getResponse(),lastRecaptchaEnabledFormID:this.formId}),e.submit((function(){t.submitting=!0})),e.onSuccess((function(){return t.submitting=!1,t.submitted=!0,!1}))},onRecaptchaVerify:function(){""!==window.grecaptcha.getResponse()?this.recaptchaVerified=!0:this.recaptchaVerified=!1},checkConditionalFields:function(){var t=this;Object.keys(this.conditionalFields).forEach((function(e){var a=t.formData.fields.find((function(t){return t.name===e})),n=!0;Object.keys(a.conditional).forEach((function(i){var s=a.conditional[i];Array.isArray(s)?-1===s.indexOf(t.form[i])&&(n=!1):t.form[i]!==s&&(n=!1),t.conditionalFields[e]=!!n}))}))},conditionalElementClass:function(t){return!0===this.conditionalFields[t]||void 0===this.conditionalFields[t]?"":"d-none"}}}},PYRV:function(t,e,a){"use strict";var n=a("66kC");e.a=n.a},QeFQ:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vs-form",attrs:{"data-test":"vs-form"}},[a("form",{staticClass:"d-none"}),t._v(" "),t.submitted?t._e():[a("form",{on:{submit:function(e){return e.preventDefault(),t.preSubmit(e)}}},[a("fieldset",[a("legend",{staticClass:"vs-form__main-heading vs-heading--style-level-2",attrs:{"data-test":"vs-form__main-heading"}},[t._v("\n                    "+t._s(t.getTranslatedContent("heading"))+"\n                ")]),t._v(" "),t._l(t.formData.fields,(function(e,n){return a("BFormGroup",{key:e.name,class:t.conditionalElementClass(e.name),attrs:{label:t.needsLabel(e)?t.getTranslatedLabel(e.name,n):"","label-for":t.needsLabel(e)?e.name:""}},[t.isUndefined(e.descriptor)||"checkbox"!==e.element?t._e():a("legend",[t._v("\n                        "+t._s(t.getTranslatedLegend(e.name,n))+"\n                    ")]),t._v(" "),a("div",{class:t.conditionalElementClass(e.name),attrs:{"aria-live":"assertive"}},["input"===e.element?[a("VsInput",{ref:e.name,refInFor:!0,attrs:{"field-name":e.name,type:e.type,"validation-rules":e.validation||{},"validation-messages":t.getTranslatedValidation(e.name,n)||{},"generic-validation":t.getMessagingData("validation",t.language),invalid:t.errorFields.indexOf(e.name)>-1,"trigger-validate":t.triggerValidate,"hint-text":t.getTranslatedHint(e.name,n),placeholder:e.placeholder||""},on:{"status-update":t.updateFieldData}})]:t._e(),t._v(" "),"select"===e.element?[a("VsSelect",{ref:e.name,refInFor:!0,attrs:{options:t.getTranslatedOptions(e.name,n),"field-name":e.name,"validation-rules":e.validation||{},"validation-messages":t.getTranslatedValidation(e.name,n)||{},"generic-validation":t.getMessagingData("validation",t.language),invalid:t.errorFields.indexOf(e.name)>-1,"trigger-validate":t.triggerValidate,"country-list-url":t.countryListUrl,countries:e.countries,"hint-text":t.getTranslatedHint(e.name,n)},on:{"status-update":t.updateFieldData}})]:t._e(),t._v(" "),"checkbox"===e.element?[a("VsCheckbox",{key:e.name,ref:e.name,refInFor:!0,attrs:{name:e.name,value:e.value,id:e.name,label:t.getTranslatedLabel(e.name,n),"field-name":e.name,"validation-rules":e.validation||{},"validation-messages":t.getTranslatedValidation(e.name,n)||{},"generic-validation":t.getMessagingData("validation",t.language),invalid:t.errorFields.indexOf(e.name)>-1,"trigger-validate":t.triggerValidate,"optional-text":t.getMessagingData("optional",t.language),"hint-text":t.getTranslatedHint(e.name,n),"info-text":t.getTranslatedInfo(e.name,n)},on:{"status-update":t.updateFieldData}})]:t._e()],2)])}))],2),t._v(" "),a("VsRecaptcha",{staticClass:"mt-9",attrs:{"site-key":t.recaptchaKey,invalid:!t.recaptchaVerified&&t.showErrorMessage,language:t.language,"error-msg":t.getMessagingData("recaptchaError",t.language),"textarea-label":t.recaptchaTextareaLabel},on:{verified:t.onRecaptchaVerify}}),t._v(" "),a("VsButton",{staticClass:"vs-form__submit mt-9",attrs:{variant:"primary",type:"submit"},nativeOn:{click:function(e){return t.preSubmit(e)}}},[t._v("\n                "+t._s(t.getTranslatedContent("submit"))+"\n            ")])],1)],t._v(" "),a("div",{staticClass:"vs-form__no-js",attrs:{"data-test":"vs-form-no-js"}},[a("VsIcon",{staticClass:"mb-5",attrs:{name:"review",variant:"primary",size:"xl"}}),t._v(" "),a("div",[t._t("no-js")],2)],1),t._v(" "),a("div",{attrs:{"aria-live":"assertive"}},[t.submitting?a("p",[t._t("submitting")],2):t._e(),t._v(" "),t.submitted?[t.getTranslatedContent("successHeading")?a("VsHeading",{attrs:{level:"2"}},[t._v("\n                "+t._s(t.getTranslatedContent("successHeading"))+"\n            ")]):t._e(),t._v(" "),a("p",{staticClass:"vs-form__content",domProps:{innerHTML:t._s(t.getTranslatedContent("successContent"))}})]:t._e(),t._v(" "),t.submitError?a("p",[t._t("submitError")],2):t._e()],2)],2)},i=[];n._withStripped=!0},aXjO:function(t,e,a){"use strict";a.r(e);var n=a("5zGy"),i=a("PYRV"),s=(a("qX/M"),a("KHd+")),r=Object(s.a)(i.a,n.a,n.b,!1,null,null,null);r.options.__file="src/components/patterns/marketo-form/MarketoForm.vue",e.default=r.exports},p1my:function(t,e,a){},"qX/M":function(t,e,a){"use strict";var n=a("p1my");a.n(n).a}},[["aXjO",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,19,17,18,21,20,22,23,24,25,26,28,27,29,30,31,32,33,37,39,38,40,41,42,43,44,45,46,57,60,62,72,75,80,93,96,139,138,140,282,34,35,36,47,54,55,77,91,129,121,128]]])}));